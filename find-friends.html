<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Profile</title>

    <!-- Bootstrap -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- External Scripts -->
    <script src="http://code.jquery.com/jquery-latest.js"></script>
    <script src="http://www.w3schools.com/lib/w3data.js"></script>

    <!-- Local Scripts -->
    <script src="js/methods.js"></script>

  	<script type="text/javascript">
  		$(document).ready(function() {
  			showAllUsers();
  			//findFacebookFriends();
  		});

      function showAllUsers() {
        $.post("php/get-all-users.php", function(rsp) {
          var allUsers = JSON.parse(rsp);
          displayResults(allUsers);
        })
      } 

      // function findFacebookFriends() {
      //   var fbId = JSON.parse(sessionStorage.getItem("currUser")).fb_ID;
      //   var;
      //   FB.api(
      //       "/me/friends",
      //       function (response) {
      //         console.log(response);
      //         if (response && !response.error) {
      //           console.log(response);
      //         }
      //       }
      //   );
      // }

  		function displayResults(users) {
  			for (var i = 0; i < users.length; i++) {
  				var id = users[i].ID;
          if (id !== currUser.ID) {
            var html = "<button type='button' class='list-group-item list-group-item-action' onclick='followUser(" + id + ")'>" + users[i].Name + "</button>";
            $("#users").append(html);
          }
  			}
  		}

      function followUser(id) {
        $.post("php/add-follower.php", {"follower": currUser.ID, "followee": id}, function(rsp) {
          if (rsp.trim() == "success") {
            alert("Succesfully Followed!");
          }
        })
      }

  	</script>
  </head>
  <body>
    <script src="js/javascript-sdk.js"></script>
    <script type="text/javascript">
      var currUser = JSON.parse(checkForUser());
      currUser = JSON.parse(currUser);
    </script>

  	<!--Nav Bar-->
    <div w3-include-html="partials/navbar.html"></div>

  	<!-- List of movies -->
  	<div class="container">
  		<h3>All Users</h3>
  		<div class="list-group" id="users"></div>
  	</div>

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script> -->
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="js/bootstrap.min.js"></script>
    <script type="text/javascript">
    	//Global variables

      //Include Partials
      w3IncludeHTML();

      //Initial Code
      checkForUser();
    </script>
  </body>
</html>